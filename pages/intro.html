<!DOCTYPE html>
<html>

    <head>
        <title>heilikon_transmission</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../css/terminal.css">
        <script src="../js/vendor/jquery.js"></script>
        <script src="../js/vendor/FileSaver.min.js"></script>
        <script src="../js/MothershipCharGenerator.js"></script>
        <script type="text/javascript" src="../json/weapons.json"></script>
        <script type="text/javascript" src="../json/drugs.json"></script>
        <script type="text/javascript" src="../json/quotes.json"></script>
        <script type="text/javascript" src="../json/icd.json"></script>
        <script type="text/javascript" src="../json/moods.json"></script>
        <script type="text/javascript" src="../json/descriptions.json"></script>
        <script src="../js/vendor/chance.js"></script>

    </head>
    <style>
        img {
            mix-blend-mode: normal;
            border: 2px solid #14fdce;
            margin: 5px;
        }
    </style>

    <body id='body'>
        <pre style="line-height: 0.8em; font-size: 1vw;" class="noselect">



██╗  ██╗ ███████╗ ██╗ ██╗      ██╗ ██╗  ██╗ ██████╗  ███╗   ██╗
██║  ██║ ██╔════╝ ██║ ██║      ██║ ██║ ██╔╝██╔═══██╗ ████╗  ██║
███████║ █████╗   ██║ ██║      ██║ █████╔╝ ██║   ██║ ██╔██╗ ██║
██╔══██║ ██╔══╝   ██║ ██║      ██║ ██╔═██╗ ██║   ██║ ██║╚██╗██║
██║  ██║ ███████╗ ██║ ███████╗ ██║ ██║ ╚██╗╚██████╔╝ ██║ ╚████║
╚═╝  ╚═╝ ╚══════╝ ╚═╝ ╚══════╝ ╚═╝ ╚═╝  ╚═╝ ╚═════╝  ╚═╝  ╚═══╝



</pre>
        <p class="terminal-mode noselect">Live Well®</p>
        <a class="terminal-mode noselect" onclick="playIntro()" href="javascript:void(0);">>PRESS ENTER TO CONTINUE . . .</a>
        <p id='text'></p>
        <p class='visible noselect' style="line-height: 2rem;"></p>
        <p class="invisible noselect"><br><br><br><br><br><br><br><br><br><br></p>
        <div id="glow" class="glow noclick"></div>
        <div id="noisy" class="noisy noclick"></div>
        <div id="scanline" class="scanlines noclick"></div>
        <script>
            var text = 'Loading HEILIKON_OS.SYS . . .`Starting H_OS . . .`	testing extended memory . . . done.`	testing Hard Disk Drive(s) . . . done.`	testing Diskette Drive(s) . . . done.`CP/M-77 for the HDC 402, Vers. 1.1.8a (Patched)`Copyright © 2122, Heilikon``Return/TAP       : Increase output speed`Space/DOUBLE TAP : Skip to end of output`+/-              : adjust volume`'
            var soFar = "";
            var printing = false;
            var speed = 50;
            var volume = 0.5;
            var cg = new MothershipCharGenerator();
            var mylatesttap = new Date().getTime();

            var visible = document.querySelector(".visible");

            var audio_intro = new Audio('../audio/intro.mp3');
            var audio_entry = new Audio('../audio/entry.m4a');
            var audio_noise = new Audio('../audio/console.m4a');
            changeVolume(volume);
            audio_noise.loop = true;


            var addChar = function() {
                if (text.substr(0, 1) == '`') {
                    soFar += '<br>', text = text.substr(1);
                    document.documentElement.scrollTo({
                        left: 0,
                        top: document.documentElement.scrollHeight - document.documentElement.clientHeight,
                        behavior: 'auto'
                    });
                } else if (text.substr(0, 1) == ' ') {
                    soFar += ' ', text = text.substr(1);
                } else if (text.substr(0, 1) == '^') {
                    text = text.substr(1);
                } else if (text.substr(0, 1) == '@') {
                    if (text.substr(1, 1) == '1') {
                        soFar += '<br><br><img class="noselect" src="../img/mosh10.gif"><br>';
                        text = text.substr(2);
                    } else if (text.substr(1, 1) == '2') {
                        var d = new Date();
                        var n = d.getTime()
                        soFar += `<img src="https://thispersondoesnotexist.com/image?${n}" style="max-width: 50%;" onclick="javascript:changeIMG(this)" >\n`
                        // soFar += '<br><br><img class="noselect" src="../img/mosh9.gif"><br>';
                        text = text.substr(2);
                    } else if (text.substr(1, 1) == '3') {
                        soFar += '<a class="terminal-mode" onclick="dl_txt()" target="_blank">\>DOWNLOAD</a><br>';
                        text = text.substr(2);
                    }
                } else {
                    playEntry();
                    soFar += text.substr(0, 1), text = text.substr(1);
                }
                visible.innerHTML = soFar;

                if (text.length === 0) {
                    soFar += '<br><a class="terminal-mode" onclick="intro()"; href="javascript:void(0);">\>INTRO</a><br>';
                    soFar += '<a class="terminal-mode" href="images.html" target="_blank">\>IMAGES</a><br>';
                    soFar += '<a class="terminal-mode" onclick="transmission()"; href="javascript:void(0);">\>TRANSMISSION</a><br>';
                    soFar += '<a class="terminal-mode" onclick="char_creation()"; href="javascript:void(0);">\>CHARACTER CREATION</a><br>';
                    soFar += '<a class="terminal-mode" onclick="new_char()"; href="javascript:void(0);">\>NEW CHARACTER</a><br>';
                    visible.innerHTML = soFar;
                    printing = false;
                    return 0;
                }
                setTimeout(addChar, speed);
            }

            function playIntro() {
                $('visible').removeClass('blink');
                playIntro = noop; // swap the functions
                setTimeout(addChar, speed);
                audio_intro.play();
                audio_noise.play();
            }

            function playEntry() {
                audio_entry.currentTime = 0;
                audio_entry.play();
            }

            function changeVolume(value) {
                volume = parseFloat(Math.max(0, Math.min(1, value)));
                console.log(volume);
                audio_intro.volume = parseFloat(1.0 * volume);
                audio_entry.volume = parseFloat(1.0 * volume);
                audio_noise.volume = parseFloat(0.5 * volume);
            }

            function transmission() {
                if(!printing) {
                    printing = true
                    text = '`incoming transmission . . .`Loading ██████████████████████████████`[ERROR] DATA CORRUPTION DETECTED`running data diagnostic . . . done.`attempting recovery . . . done.`recovery ratio . . . 74%`printing message . . .`>>ALERT<<`DISPATCH: Alexis Science Vessel`MESSAGE BEGINS`==================`>> �CAPTA�NS LOG AL�XIS.2245`>> CRITICAL MISSION �AILURE�`>> MULTIP�E CASU��TIES`>> SHIP IN�PERABLE: C�USE UNKNOW�`>> OVERSIGHT CREW: MIS�ING`>> AURELAC ORG��ISM CHANGING`>> NEW AGG�ESSIVE DE�ENCE SYSTE�`>> SEVERE �TMOSPHERIC IMPAC�: NO LON��R BREATHABLE`>> INFORM RECOVERY C�EW: �O NOT BREATH� AIR`>> ATTACHMENT: SH�ULDER CAM DATA`>> PLEASE ADVISE URGENTLY`==================`MESSAGE ENDS`image data detected . . .`Loading ██████████████████████████████`[ERROR] DATA CORRUPTION DETECTED`	running data diagnostic . . . done.`	attempting recovery . . . done.`[WARNING] SEVERE DATA CORRUPTION`printing image data . . .`@1`^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^`done.`';
                    setTimeout(addChar, speed);
                    return 0;
                }
                return 1;
            }
            function intro() {
                if(!printing) {
                    printing = true
                    text = 'The future is dark, ruthless and ruled by faceless corporations.``There is no magic. There are no magical light swords. People do not wear robes they wear jumpsuits and ballistic vests. They use Kostnov Insurgent assault rifles with bolted-on digital scopes wired into H.U.D units surgically routed directly into their eye sockets.``You are space scum. You owe money to the corps.``A lot of money.``You have barely survived thus far and you will likely not survive much longer. The dire circumstances of your pitiful existence have driven you to this insane task in order to put together some small payday to get back on your feet. If you survive you will do so scarred, disfigured and running out of clean air to breathe and blood to bleed.``Space is a horrible place and out here on the outer rim it’s even worse.``';
                    setTimeout(addChar, speed);
                    return 0;
                }
                return 1;
            }
            function char_creation() {
                if(!printing) {
                    printing = true
                    text = '# Basic SciFi Character Creation`## Roll Attribute Scores`- 3d6`- Mark down modifiers`## Roll For Skills`- 2 Random Skills`- Exertion`- Interaction`- Academics`- Engineering`- Combat`- Vehicles`- Survival`- 1 Specialisation`## Note Load-out`- Random Gun`- 1d4 spare mags`- Machete / Scalpel / Crowbar`- Flare gun / Binoculars / Flashlight`- Survey kit / Camping gear / First Aid Kit`- Automed (2) / Pain pills (2) / Random Drug (2)`- 1 Stimpak`- Standard battle dress / Type 1 steel vest random style / Standard crew attire`## Roll Hitpoints`- 1d6 + CON`## Note Saving Throws`- Physical`- 15 minus the best of STR or CON`- Evasion`- 15 minus the best of DEX or INT`- Mental`- 15 minus the best of WIS or CHA`## Note Starting Stress / Resolve`- Stress: 2`- Resolve: 0`## Roll Trinket / Patch / Nightmare`- d% each`## Roll Personality`';
                    setTimeout(addChar, speed);
                    return 0;
                }
                return 1;
            }

            function new_char() {
                cg = new MothershipCharGenerator();
                text = cg.output+'@3';
                setTimeout(addChar, speed);
                return 0;
            }

            // Function to download data to a file
            function download(data, filename, type) {
                var file = new Blob([data], {type: type});
                if (window.navigator.msSaveOrOpenBlob) // IE10+
                    window.navigator.msSaveOrOpenBlob(file, filename);
                else { // Others
                    var a = document.createElement("a"),
                            url = URL.createObjectURL(file);
                    a.href = url;
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    setTimeout(function() {
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                    }, 0);
                }
            }

            function dl_txt() {
                download(cg.output.replace(/`/g, '\n').replace('@2', '').replace('@3', '').toUpperCase(), cg.name.replace(/ /g, '_').replace('.', '').toUpperCase(), "text/plain;charset=utf-8")
            }

            function skip() {
                var d = new Date();
                var n = d.getTime()
                var add = text;
                add = add.replace(/`/g, '<br>');
                add = add.replace('@1', '<br><br><img class="noselect" src="../img/mosh10.gif"><br>');
                add = add.replace('@2', `<img src="https://thispersondoesnotexist.com/image?${n}" style="max-width: 50%;" onclick="javascript:changeIMG(this)" >\n`);
                add = add.replace('@3', '<a class="terminal-mode" onclick="dl_txt()" target="_blank">\>DOWNLOAD</a><br>');
                document.documentElement.scrollTo({
                    left: 0,
                    top: document.documentElement.scrollHeight - document.documentElement.clientHeight,
                    behavior: 'auto'
                })
                text = '';
                soFar += add;
                visible.innerHTML = soFar;
            }

            function doubletap() {

                var now = new Date().getTime();
                var timesince = now - mylatesttap;
                if((timesince < 170) && (timesince > 0) && text.length > 0){
                    skip();

                }else{
                    down();
                }
                mylatesttap = new Date().getTime();
            }


            // this function does nothing
            function noop() {};
            function down(e) {
                speed = 1;
            }

            function up(e) {
                speed = 50;
            }

            function changeIMG(div){
                var d = new Date();
                var n = d.getTime();
                $(div).attr("src", `https://thispersondoesnotexist.com/image?${n}`);
                soFar = visible.innerHTML;
            }

            $(document).ready(function () {
                document.addEventListener('keydown', function (evt) {
                    if (evt.keyCode === 13) {
                        playIntro();
                        down();
                    } else if (evt.keyCode === 187) {
                        playEntry();
                        changeVolume(volume+0.05);
                    } else if (evt.keyCode === 189) {
                        playEntry();
                        changeVolume(volume-0.05);
                    } else if (evt.keyCode === 32){
                        skip();
                    }
                });
                document.addEventListener('keyup', up, false);
                document.addEventListener('touchstart', doubletap, false);
                document.addEventListener('touchend', up, false);
                document.addEventListener('mousedown', doubletap, false);
                document.addEventListener('mouseup', up, false);
            });
        </script>
    </body>
</html>
